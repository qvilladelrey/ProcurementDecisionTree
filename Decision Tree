<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Interactive Decision Tree</title>
    <style>
        body {
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 20px;
            background-image: url('Decision Tree Background.png');
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
            background-attachment: fixed;
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .decision-container {
            background: white;
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 35px 65px rgba(0.25,0.25,0.25,0.25);
            max-width: 700px;
            width: 100%;
            text-align: center;
            position: relative;
            overflow: visible;
        }

        h1 {
            font-family: 'Bricolage Grotesque', 'Arial', sans-serif;
            color: #333;
            margin-bottom: 30px;
            font-size: 2.5em;
            font-weight: 600;
        }

        .question {
            font-size: 2em;
            color: #555;
            margin-bottom: 30px;
            line-height: 1.5;
        }

        .options {
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin-bottom: 30px;
            align-items: center;
        }

        .options.horizontal {
            flex-direction: row;
            justify-content: space-between;
            flex-wrap: wrap;
        }

        .option-btn {
            background: linear-gradient(135deg, #1e3888, #3a6ea5);
            color: white;
            border: none;
            padding: 18px 25px;
            border-radius: 12px;
            font-size: 1.1em;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 500;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
            width: 100%;
            max-width: 450px;
            min-height: 80px;
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
            line-height: 1.3;
        }
        .option-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.4);
        }

        .option-btn:active {
            transform: translateY(0);
        }

        .image-option {
            background: white;
            border: 2px solid #e5e7eb;
            border-radius: 16px;
            padding: 20px 15px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
            width: 100%;
            max-width: 280px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.08);
            flex: 1;
            min-width: 140px;
        }

        .image-option:hover {
            border-color: #667eea;
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.15);
        }

        .image-option h3 {
            margin: 12px 0 6px 0;
            color: #333;
            font-size: 1.1em;
            font-weight: 600;
        }

        .image-option p {
            margin: 0;
            color: #666;
            font-size: 0.85em;
            line-height: 1.3;
        }

        .restart-btn {
            background: #28a745;
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 10px;
            font-size: 1em;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 500;
            margin-right: 10px;
        }

        .back-btn {
            background: #6c757d;
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 10px;
            font-size: 1em;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 500;
        }

        .back-btn:hover {
            background: #5a6268;
        }

        .restart-btn:hover {
            background: #218838;
            transform: translateY(-1px);
        }

        .definition-word {
            position: relative;
            cursor: help;
            color: #667eea;
            font-weight: 500;
            border-bottom: 1px dotted #667eea;
        }

        .definition-tooltip {
            position: absolute; /* or fixed if you prefer */
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%);
            background: #333;
            color: white;
            padding: 10px 16px;
            border-radius: 8px;
            font-size: 0.85em;
            white-space: normal;
            z-index: 9999; /* ensure it's on top */
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            margin-bottom: 5px;
            width: 300px;
            text-align: center;
            line-height: 1.2;
            max-height: 80px;
            overflow-y: auto;
        }

        .definition-tooltip::after {
            content: '';
            position: absolute;
            top: 100%;
            left: 50%;
            transform: translateX(-50%);
            border: 5px solid transparent;
            border-top-color: #333;
        }

        .definition-word:hover .definition-tooltip {
            opacity: 1;
            visibility: visible;
        }

        .breadcrumb-container {
            background: #f0f4fa;
            border-radius: 8px;
            padding: 12px 14px;
            margin-bottom: 15px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .breadcrumb-title {
            font-weight: bold;
            color: #1e3888;
            font-size: 1em;
            margin-bottom: 6px;
        }

        .breadcrumb-trail {
            display: flex;
            flex-wrap: wrap;
            align-items: center;
            gap: 5px;
        }

        .breadcrumb-btn {
            background: none;
            border: none;
            color: #1e3888;
            cursor: pointer;
            text-decoration: underline;
            font-size: 0.85em;
            padding: 3px 6px;
            border-radius: 3px;
            transition: all 0.2s ease;
        }
        
        .breadcrumb-btn:hover {
            color: #3a6ea5;
            background: rgba(58, 110, 165, 0.1);
        }
        
        .breadcrumb-current {
            color: #333;
            font-weight: 600;
            padding: 3px 6px;
            font-size: 0.85em;
        }

        .recommendation-container {
            margin-bottom: 20px;
        }

        .primary-recommendation {
            background: linear-gradient(135deg, #1e3888, #3a6ea5);
            color: white;
            padding: 25px;
            border-radius: 15px;
            margin-bottom: 15px;
            box-shadow: 0 8px 25px rgba(0,0,0,0.2);
            text-align: left;
        }

        .recommendation-title {
            font-weight: 700;
            font-size: 1.3em;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
        }

        .recommendation-title .icon {
            margin-right: 10px;
            font-size: 1.5em;
        }

        .recommendation-description {
            font-size: 1em;
            line-height: 1.5;
        }

        .alternative-recommendations {
            display: flex;
            flex-direction: column;
            gap: 10px;
            margin-top: 20px;
        }

        .alternative-title {
            font-weight: 600;
            color: #333;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            font-size: 1.1em;
        }

        .alternative-title .icon {
            margin-right: 8px;
            font-size: 1.2em;
        }

        .alternative-badges {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
        }

        .alternative-badge {
            background: #f8f9fa;
            color: #333;
            padding: 10px 15px;
            border-radius: 8px;
            font-size: 0.9em;
            font-weight: 500;
            display: flex;
            align-items: center;
            gap: 5px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }

        .dynamic-recommendations {
            background: #e8f4fd;
            border-radius: 12px;
            padding: 15px;
            margin-bottom: 20px;
            box-shadow: 0 6px 18px rgba(0,0,0,0.15);
        }

        .dynamic-title {
            font-weight: bold;
            color: #1e3888;
            font-size: 1.1em;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
        }

        .dynamic-title .icon {
            margin-right: 8px;
        }

        .recommendation-badges {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
        }

        .recommendation-badge {
            background: #1e3888;
            color: white;
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 0.85em;
            font-weight: 500;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .button-container {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-top: 20px;
        }

        .learn-more-btn {
            display: inline-block;
            margin-top: 12px;
            background: #1e3888;
            color: white;
            padding: 10px 16px;
            border-radius: 8px;
            text-decoration: none;
            font-weight: 500;
            transition: background 0.3s ease;
        }
        .learn-more-btn:hover {
            background: #3a6ea5;
        }
        
        .alternative-badge {
            background: #f8f9fa;
            color: #333;
            padding: 10px 15px;
            border-radius: 8px;
            font-size: 0.9em;
            font-weight: 500;
            display: flex;
            align-items: center;
            gap: 5px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            text-decoration: none;
            transition: transform 0.2s ease, box-shadow 0.2s ease;
        }
        .alternative-badge:hover {
            background: #e8f0ff;
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(0,0,0,0.15);
        }

        .feedback-btn {
          background: #007bff;
          color: white;
          border: none;
          padding: 15px 30px;
          border-radius: 10px;
          font-size: 1em;
          cursor: pointer;
          transition: all 0.3s ease;
          font-weight: 500;
        }
        
        .feedback-btn:hover {
          background: #0056b3;
          transform: translateY(-1px);
        }

        .user-guide-container {
          position: fixed;
          bottom: 25px;
          right: 25px;
          background: #1e3888;
          color: white;
          padding: 14px 20px;
          border-radius: 12px;
          font-size: 1em;
          font-weight: 500;
          box-shadow: 0 6px 18px rgba(0, 0, 0, 0.25);
          cursor: pointer;
          transition: transform 0.2s ease, box-shadow 0.2s ease;
          z-index: 9999;
        }
        
        .user-guide-container:hover {
          transform: translateY(-4px);
          box-shadow: 0 10px 22px rgba(0, 0, 0, 0.25);
        }

        @media (max-width: 768px) {
            .decision-container {
                padding: 25px;
                margin: 10px;
            }
            
            h1 {
                font-size: 1.8em;
            }
            
            .question {
                font-size: 1.1em;
            }
            
            .button-container {
                flex-direction: column;
            }
            
            .restart-btn, .back-btn {
                width: 100%;
                margin: 5px 0;
            }
        }
    </style>
</head>
<body>
    <div class="decision-container">
        <h1>Decision Tree for Modes of Procurement</h1>
        
        <!-- Breadcrumb Trail -->
        <div id="breadcrumbContainer" class="breadcrumb-container" style="display: none;">
            <div class="breadcrumb-title">Your Path:</div>
            <nav id="breadcrumbTrail" class="breadcrumb-trail">
                <!-- Breadcrumb items will be dynamically added here -->
            </nav>
        </div>

        <!-- Dynamic Recommendations Panel -->
        <div id="dynamicRecommendations" class="dynamic-recommendations" style="display: none;">
            <div class="dynamic-title">
                <span class="icon">💡</span>
                <span>Available Procurement Modes:</span>
            </div>
            <div id="recommendationBadges" class="recommendation-badges">
                <!-- Recommendation badges will be dynamically added here -->
            </div>
        </div>
        
        <div id="homeContainer">
            <div class="question" style="font-size: 1.1em; text-align: justified; margin-bottom: 30px;">
                This decision tree for modes of procurement is a step-by-step guide that uses yes/no or conditional questions to determine the most appropriate procurement method based on thresholds, conditions, and justifications. It ensures Procuring Entities choose which mode of procurement is the most fit for their desired purpose, in accordance with the <span class="definition-word">Fit-for-Purpose<span class="definition-tooltip">Fit-for-Purpose refers to an approach to procurement that applies the most suitable mechanism or strategy designed to address the specific needs of the Procuring Entity and each project, while promoting flexibility and responsiveness to different conditions and scenarios, based on factors or situations, such as, but not limited to, the nature and complexity of the project, market condition and readiness, urgency or risks, in order to ensure and achieve value for money.</span></span> Approach under Republic Act No. 12009 or the New Government Procurement Act.
            </div>
            
            <div class="options">
                <img src="START.png" onclick="startDecisionTree()" style="width: 280px; height: 90px; object-fit: cover; border-radius: 15px; cursor: pointer; transition: all 0.3s ease; box-shadow: 0 4px 15px rgba(0,0,0,0.2); display: block; margin: 0 auto;" alt="Start icon" onmouseover="this.style.transform='scale(1.05)'" onmouseout="this.style.transform='scale(1)'" onmousedown="this.style.transform='scale(0.95)'" onmouseup="this.style.transform='scale(1.05)'" onerror="this.src=''; this.alt='Image failed to load'; this.style.display='none';">
            </div>
        </div>

        <div id="questionContainer" style="display: none;">
            <div class="question" id="questionText">
                What are you procuring?
            </div>
            
            <div class="options" id="optionsContainer">
                <div class="image-option" onclick="makeChoice('goods')">
                    <img src="Billy Goods.png" style="width: 290px; height: 260px; object-fit: cover; border-radius: 8px;" alt="Goods icon" onerror="this.src=''; this.alt='Image failed to load'; this.style.display='none';">
                    <h3><span class="definition-word">Goods<span class="definition-tooltip">Goods refer to (i) all items, supplies, and  materials, whether in the nature of equipment, furniture, stationery, materials for construction, or personal property of any kind, needed in the transaction of public businesses or in the pursuit of any government undertaking, project or activity; or (ii) general support services which pertain to all types of services except Consulting Services and Infrastructure Projects, such as the repair and maintenance of equipment and furniture, as well as trucking, hauling, janitorial, security, and related or analogous services. Personnel Services or individual COS or JO engagements do not fall under this definition.</span></span></h3>
                </div>
                <div class="image-option" onclick="makeChoice('infrastructure')">
                    <img src="Billy Infra.png" style="width: 290px; height: 260px; object-fit: cover; border-radius: 8px;" alt="Infrastructure icon" onerror="this.src=''; this.alt='Image failed to load'; this.style.display='none';">
                    <h3>Infrastructure Projects</h3>
                </div>
                <div class="image-option" onclick="makeChoice('consulting')">
                    <img src="Billy Consulting.png" style="width: 290px; height: 260px; object-fit: cover; border-radius: 8px;" alt="Consulting icon" onerror="this.src=''; this.alt='Image failed to load'; this.style.display='none';">
                    <h3>Consulting Services</h3>
                </div>
            </div>
            
            <!-- Back Button -->
            <div class="button-container">
                <button onclick="goBack()" class="back-btn" id="backButton" style="display: none;">
                    ← Go Back
                </button>
            </div>
        </div>
        
        <div id="resultContainer" style="display: none;">
            <div class="recommendation-container" id="recommendationContainer">
                <!-- Primary and alternative recommendations will be inserted here -->
            </div>
            <div class="button-container">
                <button class="restart-btn" onclick="restart()">
                    🔄 Start Over
                </button>
        
        <!-- ✨ New Feedback Button -->
        <button class="feedback-btn" onclick="openFeedbackForm()">
            💬 Give Feedback
            </button>
            </div>
        </div>

        <div class="user-guide-container" onclick="openUserGuide()">
          📘 User Guide
        </div>

    </div>

    <script>
        const decisionTree = {
            start: {
                question: "What are you procuring?",
                options: {
                    goods: {
                        text: "📦 Goods",
                        next: "isthereemergency_goods"
                    },
                    infrastructure: {
                        text: "🏗️ Infrastructure Projects",
                        next: "result_under_construction"
                    },
                    consulting: {
                        text: "🤝 Consulting Services",
                        next: "result_under_construction"
                    }
                }
            },
            isthereemergency_goods: {
                question: "Is there:",
                options: {
                    imminentdanger_goods: {
                        text: "🌪️ Address imminent danger to life or property during a state of calamity",
                        next: "prefer_emergencycases_goods",
                        triggers: ["Negotiated Procurement: Emergency Cases"]
                    },
                    timeessence_goods: {
                        text: "🔥 Implement prompt measures since time is of the essence in situations arising from natural or man-made calamities",
                        next: "prefer_emergencycases_goods",
                        triggers: ["Negotiated Procurement: Emergency Cases"]
                    },
                    immediateaction_goods: {
                        text: "🚨 A need to undertake immediate action to prevent damage to or loss of life or property or to restore vital public  services, infrastructure facilities,  and other public utilities",
                        next: "prefer_emergencycases_goods",
                        triggers: ["Negotiated Procurement: Emergency Cases"]
                    },
                    otherinstancesemergency_goods: {
                        text: "⚠️ Respond to other instances aside from the mentioned situations where the provision of life, injury, disease, and other negative effects on human, physical, mental and social well-being, together with damage to property, destruction of assets, loss of services, social and economic disruption and environmental degradation",
                        next: "prefer_emergencycases_goods",
                        triggers: ["Negotiated Procurement: Emergency Cases"]
                    },
                    othersemergency_goods: {
                        text: "❓ Not among the stated options",
                        next: "cse_goods"
                    }
                }
            },
            prefer_emergencycases_goods: {
                question: "Do you prefer to:",
                options: {
                    yes_prefer_emergencycases_goods: {
                        text: "📋 Revise Annual Procurement Plan (APP) as necessary and adopt Negotiated Procurement",
                        next: "result_emergencycases"
                    },
                    different_prefer_emergencycases_goods: {
                        text: "🔄 Adopt different procurement mode",
                        next: "cse_goods"
                       }
                    }
                },
                cse_goods: {
                    question: "Is it CSE?",
                    options: {
                    yes: {
                        text: "✅ Yes",
                        next: "result_underconstruction"
                    },
                    no: {
                        text: "❌ No",
                        next: "previouslyprocured_noncse"
                    }
                }
            },
            previouslyprocured_noncse: {
                question: "Was the Good procured previously?",
                options: {
                    yes: {
                        text: "✅ Yes",
                        next: "need_noncsegoods"
                    },
                    no: {
                        text: "❌ No",
                        next: "result_underconstruction"
                    }
                }
            },
            need_noncsegoods: {
                question: "Is there a need to:",
                options: {
                    directpurchase_noncse: {
                        text: "🔄 Directly purchase from supplier that has delivered non-CSE to other government agency",
                        next: "directsales_previousprocurement_competitive"
                    },
                    takeovercontract_noncse: {
                        text: "🚨Take-over previously awarded contract that was rescinded or terminated for causes provided for in the contract and existing laws, in order to prevent damage to or loss of life or property or restore vital public services, etc.",
                        next: "contractrescinded_noncse"
                    },
                    twofailedbidding_noncse: {
                        text: "🔄 Procure again due to two (2) failures of bidding (Competitive Bidding, Limited Source Bidding, or Competitive Dialogue)",
                        next: "prefer_twofailedbidding_noncse"
                    },
                    replenishgoods_noncse: {
                        text: "📋 Replenish Goods procured under a previously awarded contract",
                        next: "repeatorder_previousprocurement_competitive_noncse"
                    },
                    othergoods_noncse: {
                        text: "❓ Not among the stated options",
                        next: "result_underconstruction"
                    }
                }
            },
            contractrescinded_noncse: {
                question: "Was the contract of the previous bidder rescinded or terminated?",
                options: {
                    yes: {
                        text: "✅ Yes",
                        next: "prefer_takeover_noncse",
                        triggers: ["Negotiated Procurement: Take-Over of Contracts"]
                    },
                    no: {
                        text: "❌ No",
                        next: "result_underconstruction"
                    }
                }
            },
            prefer_takeover_noncse: {
                question: "Do you prefer to:",
                options: {
                    yes_prefer_takeover_noncse: {
                        text: "📋 Post-Qualify and negotiate with the second (2nd) lowest Lowest Calculated (LC) or Most Advantageous (MA) bidder and adopt Negotiated Procurement",
                        next: "result_takeoverofcontracts"
                    },
                    different_prefer_takeover_noncse: {
                        text: "🔄 Adopt different procurement mode",
                        next: "result_underconstruction"
                    }
                }
            },
            directsales_previousprocurement_competitive: {
                question: "Was the original Non-CSE procured and awarded through Competitive Bidding, Limited Source Bidding, Competitive Dialogue or Unsolicited Offer with Bid Matching?",
                options: {
                    yes: {
                        text: "✅ Yes",
                        next: "directsales_certificateofsatisfactoryperformance"
                    },
                    no: {
                        text: "❌ No",
                        next: "result_underconstruction"
                    }
                }
            },
            directsales_certificateofsatisfactoryperformance: {
                question: "Did the original government agency inspect and accept the same, and has issued a certification that the supplier has satisfactorily performed its obligations under the contract?",
                options: {
                    yes: {
                        text: "✅ Yes",
                        next: "directsales_previousprocurement_sixmonths"
                    },
                    no: {
                        text: "❌ No",
                        next: "result_underconstruction"
                    }
                }
            },
            directsales_previousprocurement_sixmonths: {
                question: "Is the procurement  only initiated once within six (6) months from the acceptance of the Non-CSE by the original government agency?",
                options: {
                    yes: {
                        text: "✅ Yes",
                        next: "directsales_lowerunitprice"
                    },
                    no: {
                        text: "❌ No",
                        next: "result_underconstruction"
                    }
                }
            },
            directsales_lowerunitprice: {
                question: "Is the  contract to be executed between the PE & the supplier within the amount of the contract executed with the original government agency, and offered to the PE at the same or lower unit price offered to the original govt agency?",
                options: {
                    yes: {
                        text: "✅ Yes",
                        next: "directsales_suppliercapability"
                    },
                    no: {
                        text: "❌ No",
                        next: "result_underconstruction"
                    }
                }
            },
            directsales_suppliercapability: {
                question: "Did the supplier agree to the terms offered by the PE and remains legally, technically, and financially capable to undertake the contract with the PE?",
                options: {
                    yes: {
                        text: "✅ Yes",
                        next: "prefer_directsales",
                        triggers: ["Direct Sales"]
                    },
                    no: {
                        text: "❌ No",
                        next: "result_underconstruction"
                    }
                }
            },
            prefer_directsales: {
                question: "Do you prefer to:",
                options: {
                    yes_prefer_directsales: {
                        text: "🤝 Coordinate with the government agency that originally procured the non-CSE",
                        next: "result_directsales"
                    },
                    different_prefer_directsales: {
                        text: "🔄 Adopt different procurement mode",
                        next: "result_underconstruction"
                    }
                }
            },
            prefer_twofailedbidding_noncse: {
                question: "Do you prefer to:",
                options: {
                    yes_prefer_twofailedbidding_noncse: {
                        text: "📋 To Review terms, conditions, specifications, and cost estimates, and adjust ABC, if necessary and approved",
                        next: "result_directsales"
                    },
                    different_prefer_twofailedbidding_noncse: {
                        text: "🔄 Adopt different procurement mode",
                        next: "result_underconstruction"
                    }
                }
            },
            repeatorder_previousprocurement_competitive_noncse: {
                question: "Was the good procured under a contract previously awarded through Competitive Bidding, Limited Source Bidding, Competitive Dialogue, or Unsolicited Offer with Bid Matching?",
                options: {
                    yes: {
                        text: "✅ Yes",
                        next: "repeatorder_lowerunitprice_noncse"
                    },
                    no: {
                        text: "❌ No",
                        next: "result_underconstruction"
                    }
                }
            },
            repeatorder_lowerunitprice_noncse: {
                question: "Is the unit price equal to or lower than that provided in the original contract and the prevailing market price?",
                options: {
                    yes: {
                        text: "✅ Yes",
                        next: "repeatorder_previousprocurement_sixmonths_noncse"
                    },
                    no: {
                        text: "❌ No",
                        next: "result_underconstruction"
                    }
                }
            },
            repeatorder_previousprocurement_sixmonths_noncse: {
                question: "Is the procurement within six (6) months from the date of the NTP arising from the original contract?",
                options: {
                    yes: {
                        text: "✅ Yes",
                        next: "repeatorder_quantifiablegood_noncse"
                    },
                    no: {
                        text: "❌ No",
                        next: "result_underconstruction"
                    }
                }
            },
            repeatorder_quantifiablegood_noncse: {
                question: "Is the Good quantifiable, divisible, and consisting of at least four (4) units per item, and does not exceed 25% of the quantity of each item in the original contract?",
                options: {
                    yes: {
                        text: "✅ Yes",
                        next: "prefer_repeatorder_noncse",
                        triggers: ["Repeat Order"]
                    },
                    no: {
                        text: "❌ No",
                        next: "result_underconstruction"
                    }
                }
            },
            prefer_repeatorder_noncse: {
                question: "Do you prefer to:",
                options: {
                    yes_prefer_repeatorder_noncse: {
                        text: "🤝 Coordinate with the government agency that originally procured the non-CSE",
                        next: "result_repeatorder"
                    },
                    different_prefer_repeatorder_noncse: {
                        text: "🔄 Adopt different procurement mode",
                        next: "result_underconstruction"
                    }
                }
            },
            typeofgood_noncse_b: {
                question: "Is the Good:",
                options: {
                    petroleumproducts: {
                        text: "⛽ Petroleum Fuel, Oil and Lubricant Products",
                        next: "retailpumpprice"
                    },
                    electronicchargingdevice: {
                        text: "🚗 Electronic charging device intended for electric vehicles",
                        next: "retailpumpprice"
                    },
                    onlinesubscription: {
                        text: "💻 Online subscription",
                        next: "result_underconstruction"
                    },
                    agriculturalproduct: {
                        text: "🌾🐟 Agricultural or fishery product",
                        next: "result_underconstruction"
                    },
                    majordefenseequipment: {
                        text: "🚁 Major defense equipment or materiel deemed necessary to protect the country by the Secretary of the Department of National Defense",
                        next: "result_underconstruction"
                    },
                    scientifcscholarlyetc: {
                        text: "🔬🎨💻🎥📚 Scientific, scholarly or artistic work, exclusive technology and/or media services",
                        next: "result_underconstruction"
                    },
                    realpropertyorvenue: {
                        text: "🏢 Lease of Real Property or Venue",
                        next: "result_underconstruction"
                    },
                    othergoods_noncse: {
                        text: "❓ Not among the stated options",
                        next: "result_underconstruction"
                    }
                }
            },
            retailpumpprice: {
                question: "Is it available from retailers, dealers, or gas stations at retail pump price?",
                options: {
                    yes: {
                        text: "✅ Yes",
                        next: "immediateconsumption"
                    },
                    no: {
                        text: "❌ No",
                        next: "result_underconstruction"
                    }
                }
            },
            immediateconsumption: {
                question: "Will it be used for any official government vehicle and equipment for immediate consumption?",
                options: {
                    yes: {
                        text: "✅ Yes",
                        next: "directacquisition_abc_noncse"
                    },
                    no: {
                        text: "❌ No",
                        next: "result_underconstruction"
                    }
                }
            },
            directacquisition_abc_noncse: {
                question: "Is the ABC less than Php 200,000.00?",
                options: {
                    yes: {
                        text: "✅ Yes",
                        next: "directacquisition_invoicecompliant_noncse"
                    },
                    no: {
                        text: "❌ No",
                        next: "smallvalueprocurement_abc"
                    }
                }
            },
            directacquisition_invoicecompliant_noncse: {
                question: "Does the supplier issue invoices compliant with the Bureau of Internal Revenue (BIR) and Commission on Audit (COA)?",
                options: {
                    yes: {
                        text: "✅ Yes",
                        next: "prefer_directacquisition_noncse"
                    },
                    no: {
                        text: "❌ No",
                        next: "result_underconstruction"
                    }
                }
            },
            prefer_directacquisition_noncse: {
                question: "Do you prefer to:",
                options: {
                    yes_prefer_directacquisition_noncse: {
                        text: "🤝 Adopting Direct Acquisition",
                        next: "result_directacquisition"
                    },
                    different_prefer_directacquisition_noncse: {
                        text: "🔄 Adopt different procurement mode",
                        next: "result_underconstruction"
                    }
                }
            },
            smallvalueprocurement_abc: {
                question: "Is the ABC more than P2 million?",
                options: {
                    yes: {
                        text: "✅ Yes",
                        next: "result_competitivebidding"
                    },
                    no: {
                        text: "❌ No",
                        next: "prefer_competitivebidding_noncse"
                    }
                }
            },
            prefer_competitivebidding_noncse: {
                question: "Do you prefer/have the capacity to undertake the public bidding process?",
                options: {
                    yes: {
                        text: "✅ Yes",
                        next: "result_competitivebidding"
                    },
                    no: {
                        text: "❌ No",
                        next: "result_smallvalueprocurement"
                    }
                }
            },
            onlinesubscription_availablepsdbm: {
                question: "Is it available at PS-DBM?",
                options: {
                    yes: {
                        text: "✅ Yes",
                        next: "result_underconstruction"
                    },
                    no: {
                        text: "❌ No",
                        next: "onlinesubscription_localprovider"
                    }
                }
            },
            onlinesubscription_localprovider: {
                question: "Is there an available local service provider?",
                options: {
                    yes: {
                        text: "✅ Yes",
                        next: "result_underconstruction"
                    },
                    no: {
                        text: "❌ No",
                        next: "onlinesubscription_abc"
                    }
                }
            },
            onlinesubscription_abc: {
                question: "Is the ABC more than Php 1 million?",
                options: {
                    yes: {
                        text: "✅ Yes",
                        next: "onlinesubscription_abc_hopeapproval"
                    },
                    no: {
                        text: "❌ No",
                        next: "result_competitivebidding"
                    }
                }
            },
            onlinesubscription_abc_hopeapproval: {
                question: "Is the ABC below 5 million (with HoPE approval)?",
                options: {
                    yes: {
                        text: "✅ Yes",
                        next: "prefer_publicbidding_onlinesubscription"
                    },
                    no: {
                        text: "❌ No",
                        next: "result_competitivebidding"
                    }
                }
            },
            prefer_publicbidding_onlinesubscription: {
                question: "Do you prefer/have the capacity to undertake the public bidding process?",
                options: {
                    yes: {
                        text: "✅ Yes",
                        next: "result_competitivebidding"
                    },
                    no: {
                        text: "❌ No",
                        next: "result_smallvalueprocurement"
                    }
                }
            },
            prefer_directretail_onlinesubscription: {
                question: "Do you prefer/have the capacity to undertake the public bidding process?",
                options: {
                    yes_prefer_directacquisition_noncse: {
                        text: "🤝 Adopting Direct Acquisition",
                        next: "result_directacquisition"
                    },
                    different_prefer_directacquisition_noncse: {
                        text: "🔄 Adopt different procurement mode",
                        next: "result_underconstruction"
                    }
                }
            }
        };

        const results = {
            result_competitivebidding: {
                title: "Competitive Bidding",
                description: "This section is currently under development. Please check back later for guidance on this procurement type, or contact your procurement office for immediate assistance with your specific requirements.",
                path: []
            },
            result_limitedsourcebidding: {
                title: "Limited Source Bidding",
                description: "This section is currently under development. Please check back later for guidance on this procurement type, or contact your procurement office for immediate assistance with your specific requirements.",
                path: []
            },
            result_competitivedialogue: {
                title: "Competitive Dialogue",
                description: "This section is currently under development. Please check back later for guidance on this procurement type, or contact your procurement office for immediate assistance with your specific requirements.",
                path: []
            },
            result_unsolicitedofferwithbidmatching: {
                title: "Unsolicited Offer with Bid Matching",
                description: "This section is currently under development. Please check back later for guidance on this procurement type, or contact your procurement office for immediate assistance with your specific requirements.",
                path: []
            },
            result_directcontracting: {
                title: "Direct Contracting",
                description: "This section is currently under development. Please check back later for guidance on this procurement type, or contact your procurement office for immediate assistance with your specific requirements.",
                path: []
            },
            result_directacquisition: {
                title: "Direct Acquisition",
                description: "This section is currently under development. Please check back later for guidance on this procurement type, or contact your procurement office for immediate assistance with your specific requirements.",
                path: []
            },
            result_repeatorder: {
                title: "Repeat Order",
                description: "This section is currently under development. Please check back later for guidance on this procurement type, or contact your procurement office for immediate assistance with your specific requirements.",
                path: []
            },
            result_smallvalueprocurement: {
                title: "Small Value Procurement",
                description: "This section is currently under development. Please check back later for guidance on this procurement type, or contact your procurement office for immediate assistance with your specific requirements.",
                path: []
            },
            result_twofailedbiddings: {
                title: "Negotiated Procurement: Two-Failed Biddings",
                description: "This section is currently under development. Please check back later for guidance on this procurement type, or contact your procurement office for immediate assistance with your specific requirements.",
                path: []
            },
            result_emergencycases: {
                title: "Negotiated Procurement: Emergency Cases",
                description: "This section is currently under development. Please check back later for guidance on this procurement type, or contact your procurement office for immediate assistance with your specific requirements.",
                link: "Negotiated Procurement_Emergency Cases.pdf",
                path: []
            },
            result_takeoverofcontracts: {
                title: "Negotiated Procurement: Take-Over of Contracts",
                description: "This section is currently under development. Please check back later for guidance on this procurement type, or contact your procurement office for immediate assistance with your specific requirements.",
                path: []
            },
            result_adjacentorcontiguous: {
                title: "Negotiated Procurement: Adjacent or Contiguous",
                description: "This section is currently under development. Please check back later for guidance on this procurement type, or contact your procurement office for immediate assistance with your specific requirements.",
                path: []
            },
            result_agencytoagency: {
                title: "Negotiated Procurement: Agency-to-Agency",
                description: "This section is currently under development. Please check back later for guidance on this procurement type, or contact your procurement office for immediate assistance with your specific requirements.",
                path: []
            },
            result_scientificscholarlyetc: {
                title: "Negotiated Procurement: Scientific, Scholarly or Artistic Work, Exclusive Technology and Media Services",
                description: "This section is currently under development. Please check back later for guidance on this procurement type, or contact your procurement office for immediate assistance with your specific requirements.",
                path: []
            },
            result_highlytechnicalconsultants: {
                title: "Negotiated Procurement: Highly Technical Consultants",
                description: "This section is currently under development. Please check back later for guidance on this procurement type, or contact your procurement office for immediate assistance with your specific requirements.",
                path: []
            },
            result_defensecooperationagreement: {
                title: "Negotiated Procurement: Defense Cooperation Agreements and Inventory-Based Items",
                description: "This section is currently under development. Please check back later for guidance on this procurement type, or contact your procurement office for immediate assistance with your specific requirements.",
                path: []
            },
            result_leaseofrealproperty: {
                title: "Negotiated Procurement: Lease of Real Property and Venue",
                description: "This section is currently under development. Please check back later for guidance on this procurement type, or contact your procurement office for immediate assistance with your specific requirements.",
                path: []
            },
            result_ngoparticipation: {
                title: "Negotiated Procurement: Non-Government Organization (NGO) Participation",
                description: "This section is currently under development. Please check back later for guidance on this procurement type, or contact your procurement office for immediate assistance with your specific requirements.",
                path: []
            },
            result_communityparticipation: {
                title: "Negotiated Procurement: Community Participation",
                description: "This section is currently under development. Please check back later for guidance on this procurement type, or contact your procurement office for immediate assistance with your specific requirements.",
                path: []
            },
            result_unagencies: {
                title: "Negotiated Procurement: United Nations (UN) Agencies, International Organization or International Financing Organizations",
                description: "This section is currently under development. Please check back later for guidance on this procurement type, or contact your procurement office for immediate assistance with your specific requirements.",
                path: []
            },
            result_directretailofpol: {
                title: "🚧 Under Construction",
                description: "This section is currently under development. Please check back later for guidance on this procurement type, or contact your procurement office for immediate assistance with your specific requirements.",
                path: []
            },
            result_directsales: {
                title: "Negotiated Procurement: Direct Retail Purchase of Petroleum Fuel, Oil and Lubricant Products, Electronic Charging Devices, and Online Subscriptions",
                description: "This section is currently under development. Please check back later for guidance on this procurement type, or contact your procurement office for immediate assistance with your specific requirements.",
                path: []
            },
            result_directsales: {
                title: "Direct Sales",
                description: "This section is currently under development. Please check back later for guidance on this procurement type, or contact your procurement office for immediate assistance with your specific requirements.",
                path: []
            },
            result_directprocurementforsti: {
                title: "Direct Procurement for Science, Technology, and Innovation",
                description: "This section is currently under development. Please check back later for guidance on this procurement type, or contact your procurement office for immediate assistance with your specific requirements.",
                path: []
            },
            result_underconstruction: {
                title: "🚧 Under Construction",
                description: "This section is currently under development. Please check back later for guidance on this procurement type, or contact your procurement office for immediate assistance with your specific requirements.",
                path: []
            }
        };

        // Emoji mapping for procurement modes
        const procurementModeEmojis = {
            "Competitive Bidding": "🏆",            
            "Limited Source Bidding": "🎯",
            "Competitive Dialogue": "🤝",
            "Unsolicited Offer with Bid Matching": "⭐",
            "Direct Contracting": "🤝",
            "Direct Acquisition": "🤝",
            "Repeat Order": "📋",
            "Small Value Procurement": "💰",
            "Negotiated Procurement: Two-Failed Biddings": "🔄",
            "Negotiated Procurement: Emergency Cases": "🚨",
            "Negotiated Procurement: Take-over of Contracts": "📋",
            "Negotiated Procurement: Adjacent or Contiguous": "📋",
            "Negotiated Procurement: Agency-to-Agency": "🤝",
            "Negotiated Procurement: Scientific, Scholarly or Artistic Work, Exclusive Technology and Media Services": "🎓",
            "Negotiated Procurement: Highly Technical Consultants": "🌟",
            "Negotiated Procurement: Defense Cooperation Agreements and Inventory-Based Items": "🚁",
            "Negotiated Procurement: Lease of Real Property and Venue": "🤝",
            "Negotiated Procurement: Non-Government Organization (NGO) Participation": "🤝",
            "Negotiated Procurement: Community Participation": "🤝",
            "Negotiated Procurement: United Nations (UN) Agencies, International Organization or International Financing Organizations": "🤝",
            "Negotiated Procurement: Direct Retail Purchase of Petroleum Fuel, Oil and Lubricant Products, Electronic Charging Devices, and Online Subscriptions": "🤝",
            "Direct Sales": "🔄",
            "Direct Procurement for Science, Technology, and Innovation": "🔬"
        };

        // Emoji mapping for procurement modes
        const procurementModeLinks = {
            "Competitive Bidding": "🏆",            
            "Limited Source Bidding": "🎯",
            "Competitive Dialogue": "🤝",
            "Unsolicited Offer with Bid Matching": "⭐",
            "Direct Contracting": "🤝",
            "Direct Acquisition": "🤝",
            "Repeat Order": "📋",
            "Small Value Procurement": "💰",
            "Negotiated Procurement: Two-Failed Biddings": "🔄",
            "Negotiated Procurement: Emergency Cases": "Negotiated Procurement_Emergency Cases.pdf",
            "Negotiated Procurement: Take-over of Contracts": "📋",
            "Negotiated Procurement: Adjacent or Contiguous": "📋",
            "Negotiated Procurement: Agency-to-Agency": "🤝",
            "Negotiated Procurement: Scientific, Scholarly or Artistic Work, Exclusive Technology and Media Services": "🎓",
            "Negotiated Procurement: Highly Technical Consultants": "🌟",
            "Negotiated Procurement: Defense Cooperation Agreements and Inventory-Based Items": "🚁",
            "Negotiated Procurement: Lease of Real Property and Venue": "🤝",
            "Negotiated Procurement: Non-Government Organization (NGO) Participation": "🤝",
            "Negotiated Procurement: Community Participation": "🤝",
            "Negotiated Procurement: United Nations (UN) Agencies, International Organization or International Financing Organizations": "🤝",
            "Negotiated Procurement: Direct Retail Purchase of Petroleum Fuel, Oil and Lubricant Products, Electronic Charging Devices, and Online Subscriptions": "🤝",
            "Direct Sales": "🔄",
            "Direct Procurement for Science, Technology, and Innovation": "🔬"
        };

        let currentNode = 'start';
        let userPath = [];
        let breadcrumbPath = [];
        let availableModes = new Set();
        let history = [];

        function updateBreadcrumb() {
          const breadcrumbContainer = document.getElementById('breadcrumbContainer');
          const breadcrumbTrail = document.getElementById('breadcrumbTrail');
          breadcrumbTrail.innerHTML = '';
        
          // Add home button
          const homeButton = document.createElement('button');
          homeButton.className = 'breadcrumb-btn';
          homeButton.textContent = '🏠 Home';
          homeButton.onclick = () => restart();
          breadcrumbTrail.appendChild(homeButton);
        
          // Helper to truncate text
          function truncate(text, maxLength = 24) {
            if (text.length > maxLength) {
              return text.slice(0, maxLength - 3) + '...';
            }
            return text;
          }
        
          // Determine which breadcrumbs to show
          let itemsToShow = [];
          if (breadcrumbPath.length > 5) {
            // Show first, ellipsis, last 3
            itemsToShow = [
              { text: breadcrumbPath[0], index: 0 },
              { text: '...', isEllipsis: true },
              ...breadcrumbPath.slice(-3).map((text, i) => ({
                text,
                index: breadcrumbPath.length - 3 + i
              }))
            ];
          } else {
            itemsToShow = breadcrumbPath.map((text, i) => ({ text, index: i }));
          }
        
          // Render breadcrumbs
          itemsToShow.forEach((item, idx) => {
            // Separator
            const separator = document.createElement('span');
            separator.textContent = ' / ';
            separator.style.color = '#999';
            breadcrumbTrail.appendChild(separator);
        
            if (item.isEllipsis) {
              // Ellipsis, not clickable
              const ellipsis = document.createElement('span');
              ellipsis.className = 'breadcrumb-current';
              ellipsis.textContent = '...';
              breadcrumbTrail.appendChild(ellipsis);
            } else if (item.index < breadcrumbPath.length - 1) {
              // Clickable breadcrumb
              const breadcrumbBtn = document.createElement('button');
              breadcrumbBtn.className = 'breadcrumb-btn';
              breadcrumbBtn.textContent = truncate(item.text);
              breadcrumbBtn.title = item.text; // Show full text on hover
              breadcrumbBtn.onclick = () => navigateToStep(item.index);
              breadcrumbTrail.appendChild(breadcrumbBtn);
            } else {
              // Current breadcrumb (not clickable)
              const breadcrumbItem = document.createElement('span');
              breadcrumbItem.className = 'breadcrumb-current';
              breadcrumbItem.textContent = truncate(item.text);
              breadcrumbItem.title = item.text;
              breadcrumbTrail.appendChild(breadcrumbItem);
            }
          });
        
          // Show/hide container
          if (breadcrumbPath.length > 0) {
            breadcrumbContainer.style.display = 'block';
          } else {
            breadcrumbContainer.style.display = 'none';
          }
        }

        function updateDynamicRecommendations() {
            const dynamicContainer = document.getElementById('dynamicRecommendations');
            const badgesContainer = document.getElementById('recommendationBadges');
            
            badgesContainer.innerHTML = '';
            
            if (availableModes.size > 0) {
                // Convert Set to Array and create badges
                Array.from(availableModes).forEach(mode => {
                    const badge = document.createElement('div');
                    badge.className = 'recommendation-badge';
                    badge.innerHTML = `${procurementModeEmojis[mode] || '📋'} ${mode}`;
                    badgesContainer.appendChild(badge);
                });
                
                dynamicContainer.style.display = 'block';
            } else {
                dynamicContainer.style.display = 'none';
            }
        }

        function makeChoice(choice) {
            const currentNodeData = decisionTree[currentNode];
            const selectedOption = currentNodeData.options[choice];
            
            // Save current state to history
            history.push({
                node: currentNode,
                path: [...breadcrumbPath],
                modes: new Set(availableModes)
            });
            
            userPath.push(selectedOption.text);
            breadcrumbPath.push(selectedOption.text);
            
            // Add any triggered procurement modes to available modes
            if (selectedOption.triggers) {
                selectedOption.triggers.forEach(mode => {
                    availableModes.add(mode);
                });
            }
            
            currentNode = selectedOption.next;
            
            updateBreadcrumb();
            updateDynamicRecommendations();
            updateBackButton();
            
            if (currentNode.startsWith('result_')) {
                showResult();
            } else {
                showQuestion();
            }
        }

        function goBack() {
            if (history.length === 0) return;
            
            // Get previous state from history
            const previousState = history.pop();
            
            // Restore previous state
            currentNode = previousState.node;
            breadcrumbPath = previousState.path;
            availableModes = previousState.modes;
            
            updateBreadcrumb();
            updateDynamicRecommendations();
            updateBackButton();
            showQuestion();
        }

        function navigateToStep(stepIndex) {
            // Clear history and available modes
            history = history.slice(0, stepIndex);
            availableModes.clear();
            
            // Rebuild available modes up to the selected step
            for (let i = 0; i <= stepIndex; i++) {
                if (history[i] && history[i].modes) {
                    history[i].modes.forEach(mode => availableModes.add(mode));
                }
            }
            
            // Update breadcrumb path
            breadcrumbPath = breadcrumbPath.slice(0, stepIndex + 1);
            
            // Find the node for this step
            let tempNode = 'start';
            for (let i = 0; i <= stepIndex; i++) {
                const step = breadcrumbPath[i];
                const nodeData = decisionTree[tempNode];
                for (let optionKey in nodeData.options) {
                    if (nodeData.options[optionKey].text === step) {
                        tempNode = nodeData.options[optionKey].next;
                        break;
                    }
                }
            }
            
            currentNode = tempNode;
            
            updateBreadcrumb();
            updateDynamicRecommendations();
            updateBackButton();
            showQuestion();
        }

        function updateBackButton() {
            const backButton = document.getElementById('backButton');
            if (history.length > 0) {
                backButton.style.display = 'block';
            } else {
                backButton.style.display = 'none';
            }
        }

        function showQuestion() {
            document.getElementById('homeContainer').style.display = 'none';
            document.getElementById('questionContainer').style.display = 'block';
            document.getElementById('resultContainer').style.display = 'none';
            document.getElementById('dynamicRecommendations').style.display = 'block';
            
            const nodeData = decisionTree[currentNode];
            document.getElementById('questionText').textContent = nodeData.question;
            
            const optionsContainer = document.getElementById('optionsContainer');
            
            // Only replace with image options for the first question
            if (currentNode === 'start') {
                optionsContainer.innerHTML = `
                    <div class="image-option" onclick="makeChoice('goods')">
                        <img src="Billy Goods.png" style="width: 290px; height: 260px; object-fit: cover; border-radius: 8px;" alt="Goods icon" onerror="this.src=''; this.alt='Image failed to load'; this.style.display='none';">
                        <h3>Goods</h3>
                    </div>
                    <div class="image-option" onclick="makeChoice('infrastructure')">
                        <img src="Billy Infra.png" style="width: 290px; height: 260px; object-fit: cover; border-radius: 8px;" alt="Infrastructure icon" onerror="this.src=''; this.alt='Image failed to load'; this.style.display='none';">
                        <h3>Infrastructure Projects</h3>
                    </div>
                    <div class="image-option" onclick="makeChoice('consulting')">
                        <img src="Billy Consulting.png" style="width: 290px; height: 260px; object-fit: cover; border-radius: 8px;" alt="Consulting icon" onerror="this.src=''; this.alt='Image failed to load'; this.style.display='none';">
                        <h3>Consulting Services</h3>
                    </div>
                `;
            } else {
                // Use image options for yes/no questions
                if (currentNode === 'cse_goods' || 
                    currentNode === 'previouslyprocured_noncse' || 
                    currentNode === 'contractrescinded_noncse' ||
                    currentNode === 'directsales_previousprocurement_competitive' ||
                    currentNode === 'directsales_certificateofsatisfactoryperformance' ||
                    currentNode === 'directsales_previousprocurement_sixmonths' ||
                    currentNode === 'directsales_lowerunitprice' ||
                    currentNode === 'directsales_suppliercapability' ||
                    currentNode === 'repeatorder_previousprocurement_competitive_noncse' ||
                    currentNode === 'repeatorder_lowerunitprice_noncse' ||
                    currentNode === 'repeatorder_previousprocurement_sixmonths_noncse' ||
                    currentNode === 'repeatorder_quantifiablegood_noncse' ||
                    currentNode === 'retailpumpprice' ||
                    currentNode === 'immediateconsumption' ||
                    currentNode === 'directacquisition_abc_noncse' ||
                    currentNode === 'directacquisition_invoicecompliant_noncse' ||
                    currentNode === 'smallvalueprocurement_abc' ||
                    currentNode === 'prefer_competitivebidding_noncse') {
                    optionsContainer.className = 'options horizontal';
                    optionsContainer.innerHTML = `
                        <div class="image-option" onclick="makeChoice('yes')">
                            <img src="YES.png" style="width: 130px; height: 70px; object-fit: cover; border-radius: 1px;" alt="Yes icon" onerror="this.src=''; this.alt='Image failed to load'; this.style.display='none';">
                        </div>
                        <div class="image-option" onclick="makeChoice('no')">
                            <img src="NO.png" style="width: 130px; height: 70px; object-fit: cover; border-radius: 1px;" alt="No icon" onerror="this.src=''; this.alt='Image failed to load'; this.style.display='none';">
                        </div>
                    `;
                } else {
                    // Use regular buttons for other questions
                    optionsContainer.className = 'options';
                    optionsContainer.innerHTML = '';
                    
                    for (let optionKey in nodeData.options) {
                        const option = nodeData.options[optionKey];
                        const button = document.createElement('button');
                        button.className = 'option-btn';
                        button.textContent = option.text;
                        button.onclick = () => makeChoice(optionKey);
                        optionsContainer.appendChild(button);
                    }
                }
            }
        }

        function showResult() {
            const result = results[currentNode];
            
            document.getElementById('homeContainer').style.display = 'none';
            document.getElementById('questionContainer').style.display = 'none';
            document.getElementById('resultContainer').style.display = 'block';
            
            const recommendationContainer = document.getElementById('recommendationContainer');
            recommendationContainer.innerHTML = '';

            // ✅ Prevent duplication of the main recommendation
            for (let mode of availableModes) {
                if (mode.toLowerCase().trim() === result.title.toLowerCase().trim()) {
                    availableModes.delete(mode);
                    break;
                }
            }

            document.getElementById('homeContainer').style.display = 'none';
            document.getElementById('questionContainer').style.display = 'none';
            document.getElementById('resultContainer').style.display = 'block';
            
            // Create primary recommendation with clickable link
            const primaryRecommendation = document.createElement('div');
            primaryRecommendation.className = 'primary-recommendation';
            primaryRecommendation.innerHTML = `
                <div class="recommendation-title">
                    <span class="icon">🏆</span>
                    <span>Primary Recommendation</span>
                </div>
                <div class="recommendation-description">
                    <strong>${result.title}</strong><br><br>
                    ${result.description}
                    ${result.link ? `<br><br><a href="${result.link}" target="_blank" class="learn-more-btn">🔗 Learn more about this mode</a>` : ''}
                </div>
            `;
            recommendationContainer.appendChild(primaryRecommendation);
            
            // Create alternative recommendations with clickable badges
            if (availableModes.size > 0) {
                const alternativeContainer = document.createElement('div');
                alternativeContainer.className = 'alternative-recommendations';
                
                const alternativeTitle = document.createElement('div');
                alternativeTitle.className = 'alternative-title';
                alternativeTitle.innerHTML = '<span class="icon">💡</span> Other Recommended Procurement Modes:';
                alternativeContainer.appendChild(alternativeTitle);
                
                const alternativeBadges = document.createElement('div');
                alternativeBadges.className = 'alternative-badges';
                
                Array.from(availableModes).forEach(mode => {
                    const badge = document.createElement('a');
                    badge.className = 'alternative-badge';
                    badge.href = procurementModeLinks[mode] || '#';
                    badge.target = '_blank';
                    badge.innerHTML = `${procurementModeEmojis[mode] || '📋'} ${mode}`;
                    alternativeBadges.appendChild(badge);
                });
                
                alternativeContainer.appendChild(alternativeBadges);
                recommendationContainer.appendChild(alternativeContainer);
            }
            
            document.getElementById('dynamicRecommendations').style.display = 'none';
        }

        function startDecisionTree() {
            document.getElementById('homeContainer').style.display = 'none';
            document.getElementById('questionContainer').style.display = 'block';
            document.getElementById('dynamicRecommendations').style.display = 'block';
            showQuestion();
        }

        function restart() {
            // Reset all variables completely
            currentNode = 'start';
            userPath = [];
            breadcrumbPath = [];
            availableModes.clear();
            history = [];
    
            // Reset all UI elements - GO TO FIRST QUESTION INSTEAD OF HOME
            document.getElementById('homeContainer').style.display = 'none';
            document.getElementById('questionContainer').style.display = 'block';
            document.getElementById('resultContainer').style.display = 'none';
            document.getElementById('breadcrumbContainer').style.display = 'none';
            document.getElementById('dynamicRecommendations').style.display = 'block';
            document.getElementById('backButton').style.display = 'none';
            
            // Clear any dynamic content
            document.getElementById('recommendationBadges').innerHTML = '';
            document.getElementById('recommendationContainer').innerHTML = '';
            
            // Show the first question
            showQuestion();
        }

        // Initialize - FIXED: Show home screen instead of first question
        document.getElementById('homeContainer').style.display = 'block';
        document.getElementById('questionContainer').style.display = 'none';
        document.getElementById('resultContainer').style.display = 'none';
        document.getElementById('breadcrumbContainer').style.display = 'none';
        document.getElementById('dynamicRecommendations').style.display = 'none';

        function openFeedbackForm() {
        window.open('https://forms.office.com/Pages/ResponsePage.aspx?id=t4cJLfDqkEG0q9B_9ONFBILVbW3cIK9Grl4vnQmaLbpUNFZaSkMwOUUyR0MyQ0pRMUVUSFVNN080UCQlQCN0PWcu', '_blank');
        }

        function openUserGuide() {
          window.open('User_Guide.pdf', '_blank'); 
        }

</script>
